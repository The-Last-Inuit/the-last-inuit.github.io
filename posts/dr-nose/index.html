<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  
  
    
  
  <meta name="description" content="Software engineering à la Mexicana">

  <title>Dr. Nose | updates</title>
  <link rel="icon" type="image/png" sizes="32x32" href="https://idunnowhatiamdoing.engineering/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://idunnowhatiamdoing.engineering/img/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://idunnowhatiamdoing.engineering/img/apple-touch-icon.png">
  
  <style>
  @import url("https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap");

  /* light mode colors */
  body {
    --primary-color: #5871a2;
    --primary-pale-color: #5871a233;
    --primary-decoration-color: #5871a210;
    --bg-color: #ffffff;
    --text-color: #2f3030;
    --text-pale-color: #767676;
    --text-decoration-color: #a9a9a9;
    --highlight-mark-color: #5f75b020;

    --callout-note-color: #5871a2;
    --callout-tip-color: #268556;
    --callout-important-color: #885fc9;
    --callout-warning-color: #ab6632;
    --callout-caution-color: #c64e4e;
  }

  /* dark mode colors */
  body.dark {
    --primary-color: #6f8fd1;
    --primary-pale-color: #6f8fd166;
    --primary-decoration-color: #6f8fd112;
    --bg-color: #1c1c1c;
    --text-color: #c1c1c1;
    --text-pale-color: #848484;
    --text-decoration-color: #5f5f5f;
    --highlight-mark-color: #8296cb3b;

    --callout-note-color: #6f8fd1;
    --callout-tip-color: #47976f;
    --callout-important-color: #9776cd;
    --callout-warning-color: #ad7a52;
    --callout-caution-color: #d06161;
  }

  /* typography */
  body {
    --main-font: "Share Tech Mono", monospace;
    --code-font: "Share Tech Mono", monospace;
    --homepage-max-width: 81ch;
    --main-max-width: 81ch;
    --avatar-size: 60px;
    --font-size: 16px;
    --line-height: 1.75;
    --img-border-radius: 0px;
    --detail-border-radius: 0px;
    --dark-mode-img-brightness: 0.75;
    --dark-mode-chart-brightness: 0.75;
    --inline-code-border-radius: 2px;
    --inline-code-bg-color: var(--primary-decoration-color);
    --block-code-border-radius: 0px;
    --block-code-border-color: var(--primary-color);
    --detail-border-color: var(--primary-color);
  }
</style>

  <link rel="stylesheet" href="https://idunnowhatiamdoing.engineering/main.css">
  

<link id="hl" rel="stylesheet" type="text/css" href="/hl-light.css" />



  
</head>

<body class="post">
  
  
<div id="wrapper">
  <div id="blank"></div>
  <aside>
    
    
    <nav>
      <ul>
        
        <li>
          <a class="h2" href="#data-flow-overview">Data flow overview</a>
          
        </li>
        
        <li>
          <a class="h2" href="#radiotap-and-802-11-decoding">Radiotap and 802.11 decoding</a>
          
        </li>
        
        <li>
          <a class="h2" href="#live-tailing-a-growing-pcap">Live tailing a growing PCAP</a>
          
        </li>
        
        <li>
          <a class="h2" href="#aggregation-and-memory-hygiene">Aggregation and memory hygiene</a>
          
        </li>
        
        <li>
          <a class="h2" href="#persistence-and-export">Persistence and export</a>
          
        </li>
        
        <li>
          <a class="h2" href="#filtering-and-frame-inspection">Filtering and frame inspection</a>
          
        </li>
        
        <li>
          <a class="h2" href="#testing-the-decoder">Testing the decoder</a>
          
        </li>
        
        <li>
          <a class="h2" href="#operational-guidance">Operational guidance</a>
          
        </li>
        
      </ul>
    </nav>
    
    
    <button id="back-to-top" aria-label="back to top">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>

    </button>
    
  </aside>
  <main>
    
<header>
  <nav>
    <a id="back-link" href="https:&#x2F;&#x2F;idunnowhatiamdoing.engineering&#x2F;posts">← back</a>
  </nav>
</header>


    <div>
      
      
      
      
      <div id="copy-cfg" style="display: none;" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
"></div>
      
      <article class="prose">
        <h1>Dr. Nose | updates</h1>
        <div id="post-info">
          <div id="date">
            <span id="publish">Jan 22, 2026</span>
            </div>

          
        </div>

        
        

        

        <p><img src="/img/dr-nose.png" alt="dr-nose" /></p>
<p>Wi-Fi recon is mostly about observation: detect beacons, learn BSSIDs, map channels, and track signal behavior over time. Dr. Nose is a small Rust app that stays strictly passive while giving you an operator-friendly view of 802.11 captures. It reads monitor-mode PCAPs (radiotap + 802.11), aggregates access points, and lets you save and export frames for deeper analysis.</p>
<h2 id="data-flow-overview">Data flow overview<a class="zola-anchor" href="#data-flow-overview" aria-label="Anchor link for: data-flow-overview" style="visibility: hidden;"></a>
</h2>
<p>Dr. Nose runs a decode loop in a background thread:</p>
<ol>
<li>Read packets from a PCAP file.</li>
<li>Decode radiotap (RSSI, channel MHz) and 802.11 headers.</li>
<li>Build a frame summary for UI and aggregation.</li>
<li>Optionally save a selected frame to SQLite for later export.</li>
</ol>
<p>The UI shows a live timeline and a rolling AP list. It never transmits or injects; it's read-only on captures.</p>
<h2 id="radiotap-and-802-11-decoding">Radiotap and 802.11 decoding<a class="zola-anchor" href="#radiotap-and-802-11-decoding" aria-label="Anchor link for: radiotap-and-802-11-decoding" style="visibility: hidden;"></a>
</h2>
<p>The decoder handles two linktypes:</p>
<ul>
<li><code>LINKTYPE_IEEE802_11</code> (105)</li>
<li><code>LINKTYPE_IEEE802_11_RADIOTAP</code> (127)</li>
</ul>
<p>Radiotap parsing is intentionally minimal. It extracts only:</p>
<ul>
<li>Channel frequency in MHz</li>
<li>Antenna signal in dBm</li>
</ul>
<p>802.11 header parsing is "MVP-correct" for management and data frames. It parses frame control fields, addresses, and subtype, and then infers BSSID using the DS flags.</p>
<p>This is enough to support most recon tasks:</p>
<ul>
<li>Identify BSSID and SSID associations.</li>
<li>Track channel usage per AP.</li>
<li>Watch signal strength shifts over time.</li>
</ul>
<h2 id="live-tailing-a-growing-pcap">Live tailing a growing PCAP<a class="zola-anchor" href="#live-tailing-a-growing-pcap" aria-label="Anchor link for: live-tailing-a-growing-pcap" style="visibility: hidden;"></a>
</h2>
<p>On macOS, Wireless Diagnostics Sniffer writes to <code>/var/tmp/*.pcap</code>. Dr. Nose can tail a growing capture by periodically reopening the file and advancing to the last processed index.</p>
<p>The loop pattern is:</p>
<pre class="z-code"><code><span class="z-text z-plain">open pcap
</span><span class="z-text z-plain">skip N packets already seen
</span><span class="z-text z-plain">read new packets until EOF
</span><span class="z-text z-plain">sleep briefly and repeat
</span></code></pre>
<p>This is safe, simple, and good enough for a live feed. It avoids external dependencies and works with long-running captures while staying passive.</p>
<h2 id="aggregation-and-memory-hygiene">Aggregation and memory hygiene<a class="zola-anchor" href="#aggregation-and-memory-hygiene" aria-label="Anchor link for: aggregation-and-memory-hygiene" style="visibility: hidden;"></a>
</h2>
<p>For operational clarity, the app keeps two rolling data structures:</p>
<ul>
<li>A timeline of recent frames (bounded by <code>MAX_TIMELINE</code>).</li>
<li>An AP map keyed by BSSID (bounded by <code>MAX_APS</code>).</li>
</ul>
<p>AP pruning is LRU-like, based on the last seen timestamp. This prevents unbounded memory use when capturing in dense RF environments.</p>
<h2 id="persistence-and-export">Persistence and export<a class="zola-anchor" href="#persistence-and-export" aria-label="Anchor link for: persistence-and-export" style="visibility: hidden;"></a>
</h2>
<p>Saved frames go into SQLite with metadata plus raw bytes. The schema includes:</p>
<ul>
<li><code>dot11_type</code>, <code>dot11_subtype</code></li>
<li><code>bssid</code>, <code>ssid</code></li>
<li><code>channel_mhz</code>, <code>rssi_dbm</code></li>
<li><code>addr1</code>, <code>addr2</code>, <code>addr3</code></li>
<li><code>linktype</code></li>
<li><code>frame_blob</code></li>
</ul>
<p>Exports are supported for:</p>
<ul>
<li>PCAP: rehydrates <code>frame_blob</code> with stored timestamps and linktype.</li>
<li>CSV/JSON: metadata-focused for quick analysis pipelines.</li>
</ul>
<p>This setup works well for triage and later deep dives:</p>
<ul>
<li>Import PCAP into Wireshark</li>
<li>Pipe CSV into a recon notebook</li>
<li>Run JSON through custom automation</li>
</ul>
<h2 id="filtering-and-frame-inspection">Filtering and frame inspection<a class="zola-anchor" href="#filtering-and-frame-inspection" aria-label="Anchor link for: filtering-and-frame-inspection" style="visibility: hidden;"></a>
</h2>
<p>The UI includes filters for BSSID, SSID, channel, and frame type. Matching happens in-app without database queries.</p>
<p>Inspect mode surfaces:</p>
<ul>
<li>Type and subtype labels</li>
<li>BSSID, SSID, addresses</li>
<li>Channel and RSSI</li>
<li>Linktype and raw frame length</li>
</ul>
<p>This makes it easy to spot patterns like:</p>
<ul>
<li>Probe storms from a single client</li>
<li>Rogue AP beacons on unexpected channels</li>
<li>RSSI shifts that suggest AP movement or spoofing</li>
</ul>
<h2 id="testing-the-decoder">Testing the decoder<a class="zola-anchor" href="#testing-the-decoder" aria-label="Anchor link for: testing-the-decoder" style="visibility: hidden;"></a>
</h2>
<p>Unit tests cover:</p>
<ul>
<li>SSID and DS channel IE parsing</li>
<li>802.11 header parsing and BSSID inference</li>
<li>Radiotap fields (channel, RSSI)</li>
</ul>
<p>Tiny synthetic fixtures are enough to lock in parsing behavior without large PCAP fixtures in the repo.</p>
<h2 id="operational-guidance">Operational guidance<a class="zola-anchor" href="#operational-guidance" aria-label="Anchor link for: operational-guidance" style="visibility: hidden;"></a>
</h2>
<p>Dr. Nose is designed for ethical recon and troubleshooting:</p>
<ul>
<li>Validate AP behavior in your own environment</li>
<li>Verify capture quality and channel coverage</li>
<li>Archive evidence for incident response</li>
</ul>
<p>Always ensure you have authorization for the airspace you are monitoring. Passive observation can still fall under regulatory and organizational rules.</p>

      </article>

      
      

      
      
    </div>

    


<footer>
  <div class="left">
    <div class="copyright">
      ∅ 2026 n0um3n4
      
    </div>
  </div>

  <div class="right">
    
    
      
    
    
    <a id="rss-btn" href="https://idunnowhatiamdoing.engineering/posts/feed.xml">RSS</a>
    
    

    
  </div>
</footer>




<dialog id="rss-mask">
  <div>
    <a href="https:&#x2F;&#x2F;idunnowhatiamdoing.engineering&#x2F;posts&#x2F;feed.xml">https:&#x2F;&#x2F;idunnowhatiamdoing.engineering&#x2F;posts&#x2F;feed.xml</a>
    
    
    <button autofocus aria-label="copy" data-link="https:&#x2F;&#x2F;idunnowhatiamdoing.engineering&#x2F;posts&#x2F;feed.xml" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>

    </button>
  </div>
</dialog>



  </main>
</div>

  
<script src="/js/lightense.min.js"></script>


  <script src="https://idunnowhatiamdoing.engineering/js/main.js"></script>
</body>

</html>
